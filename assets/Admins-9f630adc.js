import{M as L,aa as Z,ab as ee,I as s,k as e,V as A,r as m,N as M,B as z}from"./index-2970b7da.js";import{A as ae,E as se,M as te,a as ne,b as re,B as ie,D as le,S as oe,P as ce,c as de,Q as me,C as ue,R as he}from"./index.es-94469cb8.js";import{A as P,U as pe,D as j,b as U,c as k,F as B,d as ge,M as fe,X as Ce,a as be,P as Ne}from"./App-139cddee.js";import{I as b,L as N}from"./Label-c5c65c59.js";import{M as we,T as ye,E as ve}from"./echo-f3b0c48a.js";import{F as ke}from"./flatpickr-b8ac2459.js";import{I as y,a as v}from"./InputGroupText-c15be458.js";import{C as xe,U as Le}from"./calendar-ae872f2d.js";import{R as Se,C as De}from"./Col-e83b01c8.js";import{C as Ae}from"./Card-7e997483.js";import{C as ze}from"./CardHeader-5396ff8e.js";import{C as Pe}from"./CardTitle-506fdd1f.js";import{C as Te}from"./check-5de50022.js";import"./emotion-memoize.esm-f5713a00.js";const Ee=new L,We=Z("admin/updateAdminStatus",async({adminId:o,status:i},{dispatch:a})=>{try{return await Ee.updateAdminStatus(o,i),a(ee.actions.updateAdminStatus({adminId:o,status:i})),i}catch(l){throw console.log(l),new Error("Error updating status")}}),Ie=["success","danger","warning","info","dark","primary","secondary"],T=new L,Re=(o,i)=>[{name:"ID",sortable:!0,maxWidth:"100px",selector:a=>a.id},{name:"Name",sortable:!0,minWidth:"225px",selector:a=>a.name,cell:a=>s("div",{className:"d-flex align-items-center",children:[a.image===""?e(P,{color:`light-${Ie[a.status]}`,content:a.name,initials:!0}):e(P,{img:`${T.baseurl()}${a.image}`}),e("div",{className:"user-info text-truncate ms-1",children:e("span",{className:"d-block fw-bold text-truncate",children:e(A,{to:`${a.id}/edit`,state:{adminDatas:a},children:a.name})})})]})},{name:"Email",sortable:!0,minWidth:"310px",selector:a=>a.email},{name:"Mobile",sortable:!0,minWidth:"250px",selector:a=>a.mobile},{name:"Type",sortable:!0,minWidth:"100px",selector:a=>a.type},{name:"Status",sortable:!0,minWidth:"175px",selector:a=>a.status,cell:a=>{const[l,d]=m.useState(parseInt(a.status,10)===1);return s("div",{className:"form-switch form-check-primary",children:[e(b,{type:"switch",name:"icon-primary",id:"icon-primary",checked:l,onChange:()=>d(!l),onClick:async()=>{try{const u=l?0:1;M.promise(i(We({adminId:a.id,status:u})),{position:"bottom-left",loading:"Updating the Status...",success:()=>(d(!l),"Saved successfully!"),error:p=>(console.log(p),"Error updating!")})}catch(u){return console.log(u),"Invalid Data!"}}}),e("div",{style:{marginTop:"-1.4rem"},children:l?"Active":"InActive"})]})}},{name:"Actions",allowOverflow:!0,cell:a=>{const l=async()=>{try{await T.deleteAdmin(a.id),console.log("Admin deleted successfully"),o()}catch(d){console.log(d)}};return s("div",{className:"d-flex",children:[s(pe,{children:[e(j,{className:"pe-1",tag:"span",style:{cursor:"pointer"},children:e(we,{size:15})}),s(U,{end:!0,children:[s(k,{tag:A,to:`${a.id}/edit`,className:"w-100",children:[e(B,{size:15}),e("span",{className:"align-middle ms-50",children:"Details"})]}),s(k,{tag:"a",href:"/",className:"w-100",onClick:d=>d.preventDefault(),children:[e(ae,{size:15}),e("span",{className:"align-middle ms-50",children:"Archive"})]}),s(k,{tag:"a",href:"/",className:"w-100",onClick:d=>{d.preventDefault(),l(a.id)},children:[e(ye,{size:15}),e("span",{className:"align-middle ms-50",children:"Delete"})]})]})]}),e(A,{to:`${a.id}/edit`,children:e(se,{size:15})})]})}}],Me=async()=>{try{return(await T.getData()).data}catch(o){console.log(o)}},je=({open:o,handleModal:i})=>{const[a,l]=m.useState(new Date);return s(te,{isOpen:o,toggle:i,className:"sidebar-sm",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e(ne,{className:"mb-1",toggle:i,close:e(Ce,{className:"cursor-pointer",size:15,onClick:i}),tag:"div",children:e("h5",{className:"modal-title",children:"New Record"})}),s(re,{className:"flex-grow-1",children:[s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"full-name",children:"Full Name"}),s(y,{children:[e(v,{children:e(ge,{size:15})}),e(b,{id:"full-name",placeholder:"Bruce Wayne"})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"post",children:"Post"}),s(y,{children:[e(v,{children:e(ie,{size:15})}),e(b,{id:"post",placeholder:"Web Developer"})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"email",children:"Email"}),s(y,{children:[e(v,{children:e(fe,{size:15})}),e(b,{type:"email",id:"email",placeholder:"brucewayne@email.com"})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"joining-date",children:"Joining Date"}),s(y,{children:[e(v,{children:e(xe,{size:15})}),e(ke,{className:"form-control",id:"joining-date",value:a,onChange:C=>l(C)})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"salary",children:"Salary"}),s(y,{children:[e(v,{children:e(le,{size:15})}),e(b,{type:"number",id:"salary"})]})]}),e(z,{className:"me-1",color:"primary",onClick:i,children:"Submit"}),e(z,{color:"secondary",onClick:i,outline:!0,children:"Cancel"})]})]})},R=new L,Ue=(o,i,a)=>{m.useEffect(()=>{let l;async function d(){const C=new ve({broadcaster:"pusher",key:"alikoza",cluster:"mt1",encrypted:!1,wsHost:"https://api.dealmanager.co.uk",wsPort:6001,wssPort:6001,disableStats:!0,forceTLS:!1,authEndpoint:`${R.baseurl().replace(/\s/g,"")}/api/admin/subscribeToAdminsList`,authorizer:(p,S)=>({authorize:async(D,g)=>{try{const f=await R.subscribeToAdminsList(D,p.name);g(!1,f.data),i(f)}catch(f){g(!0,f),o(f)}}})}),u=C.private("admins");u.listen(".App\\Events\\Admin\\AdminListUpdated",p=>{a(p)}),l=()=>{u.stopListening(".App\\Events\\Admin\\AdminListUpdated"),C.disconnect()}}return d(),()=>{l&&l()}},[])},Be=m.forwardRef((o,i)=>e("div",{className:"form-check",children:e(b,{type:"checkbox",ref:i,...o})})),ea=()=>{const[o,i]=m.useState([]),[a,l]=m.useState(!1),[d,C]=m.useState(0),[u,p]=m.useState(""),[S,D]=m.useState([]),[g,f]=m.useState([]),[$,w]=m.useState(!0),F=new L,V=be(),E=()=>l(!a),O=n=>{n.response&&n.response.status===401&&F.refreshToken()},H=n=>{},G=n=>{w(!0);const t=n.admins;f(c=>{const r=c.findIndex(h=>h.id===t.id);return r!==-1?[...c.slice(0,r),t,...c.slice(r+1)]:c}),setTimeout(()=>{w(!1),M(s("div",{className:"d-flex",children:[e("div",{className:"me-1",children:e(P,{size:"sm",color:"success",icon:e(Te,{size:12})})}),s("div",{className:"d-flex flex-column",children:[e("h6",{children:"Form Updated!"}),e("div",{}),e("span",{children:"List Updated by Admin!"})]})]}))},400)},W=async()=>{try{w(!0);const n=await Me();f(n),w(!1)}catch(n){console.log(n),w(!1)}},Q=Re(W,V);m.useEffect(()=>{W()},[]),Ue(O,H,G);const J=n=>{const t=n.target.value;let c=[];p(t),t.length&&(c=g.filter(r=>{const h=r.name.toLowerCase().startsWith(t.toLowerCase())||r.email.toLowerCase().startsWith(t.toLowerCase())||r.mobile.toLowerCase().startsWith(t.toLowerCase())||r.type.toLowerCase().startsWith(t.toLowerCase())||r.image.toLowerCase().startsWith(t.toLowerCase()),x=r.name.toLowerCase().includes(t.toLowerCase())||r.email.toLowerCase().includes(t.toLowerCase())||r.mobile.toLowerCase().startsWith(t.toLowerCase())||r.type.toLowerCase().startsWith(t.toLowerCase())||r.image.toLowerCase().startsWith(t.toLowerCase());return h||(!h&&x?x:null)}),D(c),p(t))},X=n=>{C(n.selected)},_=()=>e(he,{previousLabel:"",nextLabel:"",forcePage:d,onPageChange:n=>X(n),pageCount:u.length?Math.ceil(S.length/7):Math.ceil(g.length/7)||1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"});function q(n){let t;const c=",",r=`
`,h=Object.keys(g[0]);return t="",t+=h.join(c),t+=r,n.forEach(x=>{let I=0;h.forEach(Y=>{I>0&&(t+=c),t+=x[Y],I++}),t+=r}),t}function K(){const n=o.length>0?o:g,t=document.createElement("a");let c=q(n);if(c===null)return;const r="export.csv";c.match(/^data:text\/csv/i)||(c=`data:text/csv;charset=utf-8,${c}`),t.setAttribute("href",encodeURI(c)),t.setAttribute("download",r),t.click()}return s(m.Fragment,{children:[s(Ae,{children:[s(ze,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e(Pe,{tag:"h4",children:"Admins List"}),s("div",{className:"d-flex mt-md-0 mt-1",children:[s(Le,{children:[s(j,{color:"secondary",caret:!0,outline:!0,children:[e(oe,{size:15}),e("span",{className:"align-middle ms-50",children:"Export"})]}),s(U,{children:[s(k,{className:"w-100",children:[e(ce,{size:15}),e("span",{className:"align-middle ms-50",children:"Print"})]}),s(k,{className:"w-100",onClick:()=>K(),children:[e(B,{size:15}),e("span",{className:"align-middle ms-50",children:"CSV"})]})]})]}),s(z,{className:"ms-2",color:"primary",onClick:E,children:[e(de,{size:15}),e("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e(Se,{className:"justify-content-end mx-0",children:s(De,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e(N,{className:"me-1",for:"search-input",children:"Search"}),e(b,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:u,onChange:J})]})}),e("div",{className:"react-dataTable react-dataTable-selectable-rows",children:$?e("div",{className:"d-flex justify-content-center align-items-center py-5",children:e(Ne,{color:"primary"})}):e("div",{className:"table-responsive",children:e(me,{noHeader:!0,pagination:!0,selectableRows:!0,columns:Q,paginationPerPage:7,className:"react-dataTable",sortIcon:e(ue,{size:10}),paginationComponent:_,paginationDefaultPage:d+1,selectableRowsComponent:Be,data:u.length?S:g,onSelectedRowsChange:n=>i(n.selectedRows)})})})]}),e(je,{open:a,handleModal:E})]})};export{ea as default};
