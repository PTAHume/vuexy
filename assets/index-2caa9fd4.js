import{D as P,a0 as M,w as e,r as t,L as S,B}from"./index-799ec526.js";import{A as H,E as V,S as $,P as Q,a as K,Q as O,C as q,R as G}from"./index.es-416240ea.js";import{U as J,D as w,b as T,c as x,F as X,a as Y,P as Z}from"./App-76c3559e.js";import{I as C,L as ee}from"./Label-7980a7d7.js";import{d as ae}from"./dealSlice-2c1f3e28.js";import{M as se,T as te}from"./trash-ac8b4371.js";import{R as ne,C as re}from"./Col-740eac10.js";import{C as ie}from"./Card-2b73a7fd.js";import{C as le}from"./CardHeader-1a15b067.js";import{C as ce}from"./CardTitle-2ca3b30f.js";import{U as oe}from"./UncontrolledButtonDropdown-52abae5f.js";const de=new P,me=M("admin/updateDealStatus",async({dealId:i,status:n},{dispatch:a})=>{try{return await de.updateDealStatus(i,n),a(ae.actions.updateDealStatus({dealId:i,status:n})),n}catch(l){throw console.log(l),new Error("Error updating status")}}),k=new P,pe=(i,n)=>[{name:"ID",sortable:!0,maxWidth:"100px",selector:a=>a.id},{name:"User",sortable:!0,minWidth:"180px",cell:a=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"30px"},children:a.user_name})})},{name:"Departure",sortable:!0,minWidth:"200px",cell:a=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:a.departure_country}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_city}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_airport}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_date})]})},{name:"Arrival",sortable:!0,minWidth:"200px",cell:a=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_country}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_city}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_airport}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_date})]})},{name:"Type",sortable:!0,minWidth:"80px",cell:a=>{switch(a.delivery_type){case"hand_luggage":return"Hand Luggage";case"baggage":return"Baggage";case"dcoument":return"Document";default:return""}}},{name:"Weight (Kg)",sortable:!0,minWidth:"140px",cell:a=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"15px"},children:a.weight})})},{name:"Flight",sortable:!0,minWidth:"100x",cell:a=>e.jsx("div",{children:e.jsxs("div",{children:["Flight : ",a.flight_number]})})},{name:"Price",sortable:!0,minWidth:"70px",selector:a=>a.price},{name:"Status",sortable:!0,minWidth:"153px",selector:a=>a.status,cell:a=>{const[l,s]=t.useState(a.status),[c,o]=t.useState(l==="approved"),p=async()=>{try{const d=c?"pending":"approved";toast.promise(n(me({dealId:a.id,status:d})),{position:"bottom-left",loading:"Updating the Status...",success:()=>(o(!c),s(d),"Saved successfully!"),error:h=>(console.log(h),"Error updating!")})}catch(d){return console.log(d),"Invalid Data!"}};return e.jsxs("div",{className:"form-switch form-check-primary",children:[e.jsx(C,{type:"switch",name:"icon-primary",id:"icon-primary",checked:c,onChange:()=>o(!c),onClick:p}),e.jsx("div",{style:{marginTop:"-1.4rem"},children:c?"Active":"InActive"})]})}},{name:"Actions",allowOverflow:!0,cell:a=>{const l=async()=>{try{await k.deleteDeal(a.id),console.log("Deal deleted successfully"),i()}catch(s){console.log(s)}};return e.jsxs("div",{className:"d-flex",children:[e.jsxs(J,{children:[e.jsx(w,{className:"pe-1",tag:"span",style:{cursor:"pointer"},children:e.jsx(se,{size:15})}),e.jsxs(T,{end:!0,children:[e.jsxs(x,{tag:S,to:`${a.id}/edit`,className:"w-100",children:[e.jsx(X,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Details"})]}),e.jsxs(x,{tag:"a",href:"/",className:"w-100",onClick:s=>s.preventDefault(),children:[e.jsx(H,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Archive"})]}),e.jsxs(x,{tag:"a",href:"/",className:"w-100",onClick:s=>{s.preventDefault(),l(a.id)},children:[e.jsx(te,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Delete"})]})]})]}),e.jsx(S,{to:`${a.id}/edit`,children:e.jsx(V,{size:15})})]})}}],y=async(i=1,n=10,a="")=>{const l=i>0?i:0;try{const s=await k.getUserDeals(l,n,a),c=s.data.slice(0,-1),o=s.data[s.data.length-1].pagination,p=o.total,d=o.perPage;return{deals:c,total:p,itemsPerPage:d}}catch(s){console.log(s)}},ue=t.forwardRef((i,n)=>e.jsx("div",{className:"form-check",children:e.jsx(C,{type:"checkbox",ref:n,...i})})),Se=()=>{const[i,n]=t.useState([]),[a,l]=t.useState(!1),[s,c]=t.useState(0),[o,p]=t.useState(""),[d,h]=t.useState([]),[D,j]=t.useState(0),[b,L]=t.useState(10),[R,N]=t.useState([]),[_,v]=t.useState(!0),z=Y(),W=()=>l(!a),f=async(r=s)=>{try{v(!0);const{deals:m,total:u,itemsPerPage:g}=await y(r,b);N(m),j(u),L(g),v(!1)}catch(m){console.log(m),v(!1)}},A=pe(f,z);t.useEffect(()=>{f()},[s]);const E=async r=>{const m=r.target.value;if(p(m),m.length){const{deals:u,total:g}=await y(1,10,m);h(u),j(g)}else{const{deals:u,total:g}=await y(1,10);h([]),N(u),j(g)}},I=r=>{c(r.selected)};function U(){return e.jsx(G,{previousLabel:"",nextLabel:"",forcePage:s,onPageChange:r=>I(r),pageCount:D>0?Math.ceil(D/b):1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"})}const F=()=>U();return e.jsx(t.Fragment,{children:e.jsxs(ie,{children:[e.jsxs(le,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e.jsx(ce,{tag:"h4",children:"My Deals List"}),e.jsxs("div",{className:"d-flex mt-md-0 mt-1",children:[e.jsxs(oe,{children:[e.jsxs(w,{color:"secondary",caret:!0,outline:!0,children:[e.jsx($,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Export"})]}),e.jsx(T,{children:e.jsxs(x,{className:"w-100",children:[e.jsx(Q,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Print"})]})})]}),e.jsxs(B,{className:"ms-2",color:"primary",onClick:W,children:[e.jsx(K,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e.jsx(ne,{className:"justify-content-end mx-0",children:e.jsxs(re,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e.jsx(ee,{className:"me-1",for:"search-input",children:"Search"}),e.jsx(C,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:o,onChange:E})]})}),e.jsx("div",{className:"react-dataTable react-dataTable-selectable-rows",children:_?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(Z,{color:"primary"})}):e.jsx(O,{noHeader:!0,pagination:!0,onPageChange:r=>f(r+1),selectableRows:!0,columns:A,paginationPerPage:10,className:"react-dataTable",sortIcon:e.jsx(q,{size:10}),paginationComponent:F,paginationDefaultPage:s+1,selectableRowsComponent:ue,data:o.length?d:R,onSelectedRowsChange:r=>n(r.selectedRows)})})]})})};export{Se as default};
