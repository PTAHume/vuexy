import{M as x,aa as Z,aq as ee,I as s,k as e,V as U,r as m,N as W,B as z}from"./index-354b5d3b.js";import{A as ae,E as se,M as te,a as ne,b as re,B as le,D as ie,S as ce,P as oe,c as de,Q as me,C as ue,R as he}from"./index.es-1a324139.js";import{A as P,U as pe,D as M,b as j,c as k,F as B,d as ge,M as fe,X as Ce,a as be,P as Ne}from"./App-3c242431.js";import{I as b,L as N}from"./Label-608bb7ed.js";import{M as we,T as ye,E as ve}from"./echo-91e3c1da.js";import{F as ke}from"./flatpickr-1c399315.js";import{I as y,a as v}from"./InputGroupText-5c775d37.js";import{C as Se,U as xe}from"./calendar-31c92ab9.js";import{R as Le,C as De}from"./Col-b61f9c3e.js";import{C as Ue}from"./Card-cced0b62.js";import{C as ze}from"./CardHeader-ac8b3eea.js";import{C as Pe}from"./CardTitle-8b08e116.js";import{C as Ae}from"./check-24a5a835.js";import"./emotion-memoize.esm-f5713a00.js";const Ee=new x,Te=Z("user/updateUserStatus",async({userId:c,status:r},{dispatch:a})=>{try{return await Ee.updateUserStatus(c,r),a(ee.actions.updateUserStatus({userId:c,status:r})),r}catch(l){throw console.log(l),new Error("Error updating status")}}),Ie=["success","danger","warning","info","dark","primary","secondary"],A=new x,Re=(c,r)=>[{name:"ID",sortable:!0,maxWidth:"100px",selector:a=>a.id},{name:"Name",sortable:!0,minWidth:"225px",selector:a=>a.name,cell:a=>s("div",{className:"d-flex align-items-center",children:[a.image===""?e(P,{color:`light-${Ie[a.status]}`,content:a.name,initials:!0}):e(P,{img:`${A.baseurl()}${a.image}`}),e("div",{className:"user-info text-truncate ms-1",children:e("span",{className:"d-block fw-bold text-truncate",children:e(U,{to:`${a.id}/edit`,state:{userDatas:a},children:a.name})})})]})},{name:"Email",sortable:!0,minWidth:"310px",selector:a=>a.email},{name:"Mobile",sortable:!0,minWidth:"250px",selector:a=>a.mobile},{name:"Status",sortable:!0,minWidth:"175px",selector:a=>a.status,cell:a=>{const[l,d]=m.useState(parseInt(a.status,10)===1);return s("div",{className:"form-switch form-check-primary",children:[e(b,{type:"switch",name:"icon-primary",id:"icon-primary",checked:l,onChange:()=>d(!l),onClick:async()=>{try{const u=l?0:1;W.promise(r(Te({userId:a.id,status:u})),{position:"bottom-left",loading:"Updating the Status...",success:()=>(d(!l),"Saved successfully!"),error:p=>(console.log(p),"Error updating!")})}catch(u){return console.log(u),"Invalid Data!"}}}),e("div",{style:{marginTop:"-1.4rem"},children:l?"Active":"InActive"})]})}},{name:"Actions",allowOverflow:!0,cell:a=>{const l=async()=>{try{await A.deleteUser(a.id),console.log("User deleted successfully"),c()}catch(d){console.log(d)}};return s("div",{className:"d-flex",children:[s(pe,{children:[e(M,{className:"pe-1",tag:"span",style:{cursor:"pointer"},children:e(we,{size:15})}),s(j,{end:!0,children:[s(k,{tag:U,to:`${a.id}/edit`,className:"w-100",children:[e(B,{size:15}),e("span",{className:"align-middle ms-50",children:"Details"})]}),s(k,{tag:"a",href:"/",className:"w-100",onClick:d=>d.preventDefault(),children:[e(ae,{size:15}),e("span",{className:"align-middle ms-50",children:"Archive"})]}),s(k,{tag:"a",href:"/",className:"w-100",onClick:d=>{d.preventDefault(),l(a.id)},children:[e(ye,{size:15}),e("span",{className:"align-middle ms-50",children:"Delete"})]})]})]}),e(U,{to:`${a.id}/edit`,children:e(se,{size:15})})]})}}],We=async()=>{try{return(await A.getAllUserData()).data}catch(c){console.log(c)}},Me=({open:c,handleModal:r})=>{const[a,l]=m.useState(new Date);return s(te,{isOpen:c,toggle:r,className:"sidebar-sm",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e(ne,{className:"mb-1",toggle:r,close:e(Ce,{className:"cursor-pointer",size:15,onClick:r}),tag:"div",children:e("h5",{className:"modal-title",children:"New Record"})}),s(re,{className:"flex-grow-1",children:[s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"full-name",children:"Full Name"}),s(y,{children:[e(v,{children:e(ge,{size:15})}),e(b,{id:"full-name",placeholder:"Bruce Wayne"})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"post",children:"Post"}),s(y,{children:[e(v,{children:e(le,{size:15})}),e(b,{id:"post",placeholder:"Web Developer"})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"email",children:"Email"}),s(y,{children:[e(v,{children:e(fe,{size:15})}),e(b,{type:"email",id:"email",placeholder:"brucewayne@email.com"})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"joining-date",children:"Joining Date"}),s(y,{children:[e(v,{children:e(Se,{size:15})}),e(ke,{className:"form-control",id:"joining-date",value:a,onChange:C=>l(C)})]})]}),s("div",{className:"mb-1",children:[e(N,{className:"form-label",for:"salary",children:"Salary"}),s(y,{children:[e(v,{children:e(ie,{size:15})}),e(b,{type:"number",id:"salary"})]})]}),e(z,{className:"me-1",color:"primary",onClick:r,children:"Submit"}),e(z,{color:"secondary",onClick:r,outline:!0,children:"Cancel"})]})]})},R=new x,je=(c,r,a)=>{m.useEffect(()=>{let l;async function d(){const C=new ve({broadcaster:"pusher",key:"alikoza",cluster:"mt1",encrypted:!1,wsHost:"https://api.dealmanager.co.uk",wsPort:6001,wssPort:6001,disableStats:!0,forceTLS:!1,authEndpoint:`${R.baseurl().replace(/\s/g,"")}/api/admin/subscribeToUsersList`,authorizer:(p,L)=>({authorize:async(D,g)=>{try{const f=await R.subscribeToUsersList(D,p.name);g(!1,f.data),r(f)}catch(f){g(!0,f),c(f)}}})}),u=C.private("users");u.listen(".App\\Events\\Admin\\UserListUpdated",p=>{a(p)}),l=()=>{u.stopListening(".App\\Events\\Admin\\UserListUpdated"),C.disconnect()}}return d(),()=>{l&&l()}},[])},Be=m.forwardRef((c,r)=>e("div",{className:"form-check",children:e(b,{type:"checkbox",ref:r,...c})})),ea=()=>{const[c,r]=m.useState([]),[a,l]=m.useState(!1),[d,C]=m.useState(0),[u,p]=m.useState(""),[L,D]=m.useState([]),[g,f]=m.useState([]),[$,w]=m.useState(!0),F=new x,V=be(),E=()=>l(!a),O=n=>{n.response&&n.response.status===401&&F.refreshToken()},H=n=>{},G=n=>{w(!0);const t=n.users;f(o=>{const i=o.findIndex(h=>h.id===(t==null?void 0:t.id));return i!==-1?[...o.slice(0,i),t,...o.slice(i+1)]:o}),setTimeout(()=>{w(!1),W(s("div",{className:"d-flex",children:[e("div",{className:"me-1",children:e(P,{size:"sm",color:"success",icon:e(Ae,{size:12})})}),s("div",{className:"d-flex flex-column",children:[e("h6",{children:"Form Updated!"}),e("div",{}),e("span",{children:"List Updated by Admin!"})]})]}))},400)},T=async()=>{try{w(!0);const n=await We();f(n),w(!1)}catch(n){console.log(n),w(!1)}},Q=Re(T,V);m.useEffect(()=>{T()},[]),je(O,H,G);const q=n=>{const t=n.target.value;let o=[];p(t),t.length&&(o=g.filter(i=>{const h=i.name.toLowerCase().startsWith(t.toLowerCase())||i.email.toLowerCase().startsWith(t.toLowerCase())||i.mobile.toLowerCase().startsWith(t.toLowerCase())||i.image.toLowerCase().startsWith(t.toLowerCase()),S=i.name.toLowerCase().includes(t.toLowerCase())||i.email.toLowerCase().includes(t.toLowerCase())||i.mobile.toLowerCase().startsWith(t.toLowerCase())||i.image.toLowerCase().startsWith(t.toLowerCase());return h||(!h&&S?S:null)}),D(o),p(t))},J=n=>{C(n.selected)},X=()=>e(he,{previousLabel:"",nextLabel:"",forcePage:d,onPageChange:n=>J(n),pageCount:u.length?Math.ceil(L.length/7):Math.ceil(g.length/7)||1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"});function _(n){let t;const o=",",i=`
`,h=Object.keys(g[0]);return t="",t+=h.join(o),t+=i,n.forEach(S=>{let I=0;h.forEach(Y=>{I>0&&(t+=o),t+=S[Y],I++}),t+=i}),t}function K(){const n=c.length>0?c:g,t=document.createElement("a");let o=_(n);if(o===null)return;const i="export.csv";o.match(/^data:text\/csv/i)||(o=`data:text/csv;charset=utf-8,${o}`),t.setAttribute("href",encodeURI(o)),t.setAttribute("download",i),t.click()}return s(m.Fragment,{children:[s(Ue,{children:[s(ze,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e(Pe,{tag:"h4",children:"Users List"}),s("div",{className:"d-flex mt-md-0 mt-1",children:[s(xe,{children:[s(M,{color:"secondary",caret:!0,outline:!0,children:[e(ce,{size:15}),e("span",{className:"align-middle ms-50",children:"Export"})]}),s(j,{children:[s(k,{className:"w-100",children:[e(oe,{size:15}),e("span",{className:"align-middle ms-50",children:"Print"})]}),s(k,{className:"w-100",onClick:()=>K(),children:[e(B,{size:15}),e("span",{className:"align-middle ms-50",children:"CSV"})]})]})]}),s(z,{className:"ms-2",color:"primary",onClick:E,children:[e(de,{size:15}),e("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e(Le,{className:"justify-content-end mx-0",children:s(De,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e(N,{className:"me-1",for:"search-input",children:"Search"}),e(b,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:u,onChange:q})]})}),e("div",{className:"react-dataTable react-dataTable-selectable-rows",children:$?e("div",{className:"d-flex justify-content-center align-items-center py-5",children:e(Ne,{color:"primary"})}):e(me,{noHeader:!0,pagination:!0,selectableRows:!0,columns:Q,paginationPerPage:7,className:"react-dataTable",sortIcon:e(ue,{size:10}),paginationComponent:X,paginationDefaultPage:d+1,selectableRowsComponent:Be,data:u.length?L:g,onSelectedRowsChange:n=>r(n.selectedRows)})})]}),e(Me,{open:a,handleModal:E})]})};export{ea as default};
