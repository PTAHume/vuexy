import{D as P,a0 as Y,a5 as Z,w as e,r as i,L,B as w}from"./index-799ec526.js";import{A as ee,E as se,S as ae,P as te,a as ne,Q as le,C as re,R as ie}from"./index.es-416240ea.js";import{U as ce,D as W,b as I,c as b,F as _,d as oe,M as de,X as me,a as pe,P as ue,A as xe}from"./App-76c3559e.js";import{I as x,L as g}from"./Label-7980a7d7.js";import{M as he,T as ge}from"./trash-ac8b4371.js";import{F as je}from"./flatpickr-8c5da3e1.js";import{M as fe,a as ve,b as ye,B as be,D as Ne}from"./dollar-sign-47878bca.js";import{I as v,a as y}from"./InputGroupText-5c7d9102.js";import{C as Ce}from"./calendar-70c47cb6.js";import{u as De}from"./useSubscribeToChannel-0a8d3489.js";import{R as Se,C as ke}from"./Col-740eac10.js";import{C as we}from"./Card-2b73a7fd.js";import{C as Pe}from"./CardHeader-1a15b067.js";import{C as Te}from"./CardTitle-2ca3b30f.js";import{U as ze}from"./UncontrolledButtonDropdown-52abae5f.js";import{C as Re}from"./check-786ae700.js";import"./Fade-c46db253.js";import"./pusher-ef6f9223.js";const Ae=new P,Ee=Y("admin/updateDealStatus",async({dealId:c,status:r},{dispatch:s})=>{try{return await Ae.updateDealStatus(c,r),s(Z.actions.updateDealStatus({dealId:c,status:r})),r}catch(d){throw console.log(d),new Error("Error updating status")}}),F=new P,Le=(c,r)=>[{name:"ID",sortable:!0,maxWidth:"100px",selector:s=>s.id},{name:"User",sortable:!0,minWidth:"180px",cell:s=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"30px"},children:s.user_name})})},{name:"Departure",sortable:!0,minWidth:"200px",cell:s=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:s.departure_country}),e.jsx("div",{style:{marginTop:"5px"},children:s.departure_city}),e.jsx("div",{style:{marginTop:"5px"},children:s.departure_airport}),e.jsx("div",{style:{marginTop:"5px"},children:s.departure_date})]})},{name:"Arrival",sortable:!0,minWidth:"200px",cell:s=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:s.arrival_country}),e.jsx("div",{style:{marginTop:"5px"},children:s.arrival_city}),e.jsx("div",{style:{marginTop:"5px"},children:s.arrival_airport}),e.jsx("div",{style:{marginTop:"5px"},children:s.arrival_date})]})},{name:"Type",sortable:!0,minWidth:"80px",cell:s=>{switch(s.delivery_type){case"hand_luggage":return"Hand Luggage";case"baggage":return"Baggage";case"dcoument":return"Document";default:return""}}},{name:"Weight (Kg)",sortable:!0,minWidth:"140px",cell:s=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"15px"},children:s.weight})})},{name:"Flight",sortable:!0,minWidth:"100x",cell:s=>e.jsx("div",{children:e.jsxs("div",{children:["Flight : ",s.flight_number]})})},{name:"Price",sortable:!0,minWidth:"70px",selector:s=>s.price},{name:"Status",sortable:!0,minWidth:"153px",selector:s=>s.status,cell:s=>{const[d,n]=i.useState(s.status),[m,p]=i.useState(d==="approved"),j=async()=>{try{const u=m?"pending":"approved";toast.promise(r(Ee({dealId:s.id,status:u})),{position:"bottom-left",loading:"Updating the Status...",success:()=>(p(!m),n(u),"Saved successfully!"),error:N=>(console.log(N),"Error updating!")})}catch(u){return console.log(u),"Invalid Data!"}};return e.jsxs("div",{className:"form-switch form-check-primary",children:[e.jsx(x,{type:"switch",name:"icon-primary",id:"icon-primary",checked:m,onChange:()=>p(!m),onClick:j}),e.jsx("div",{style:{marginTop:"-1.4rem"},children:m?"Active":"InActive"})]})}},{name:"Actions",allowOverflow:!0,cell:s=>{const d=async()=>{try{await F.deleteDeal(s.id),console.log("Deal deleted successfully"),c()}catch(n){console.log(n)}};return e.jsxs("div",{className:"d-flex",children:[e.jsxs(ce,{children:[e.jsx(W,{className:"pe-1",tag:"span",style:{cursor:"pointer"},children:e.jsx(he,{size:15})}),e.jsxs(I,{end:!0,children:[e.jsxs(b,{tag:L,to:`${s.id}/edit`,className:"w-100",children:[e.jsx(_,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Details"})]}),e.jsxs(b,{tag:"a",href:"/",className:"w-100",onClick:n=>n.preventDefault(),children:[e.jsx(ee,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Archive"})]}),e.jsxs(b,{tag:"a",href:"/",className:"w-100",onClick:n=>{n.preventDefault(),d(s.id)},children:[e.jsx(ge,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Delete"})]})]})]}),e.jsx(L,{to:`${s.id}/edit`,children:e.jsx(se,{size:15})})]})}}],C=async(c=1,r=10,s="")=>{const d=c>0?c:0;try{const n=await F.getDealsData(d,r,s),m=n.data.slice(0,-1),p=n.data[n.data.length-1].pagination,j=p.total,u=p.perPage;return{deals:m,total:j,itemsPerPage:u}}catch(n){console.log(n)}},We=({open:c,handleModal:r})=>{const[s,d]=i.useState(new Date),n=e.jsx(me,{className:"cursor-pointer",size:15,onClick:r});return e.jsxs(fe,{isOpen:c,toggle:r,className:"sidebar-sm",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e.jsx(ve,{className:"mb-1",toggle:r,close:n,tag:"div",children:e.jsx("h5",{className:"modal-title",children:"New Record"})}),e.jsxs(ye,{className:"flex-grow-1",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx(g,{className:"form-label",for:"full-name",children:"Full Name"}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(oe,{size:15})}),e.jsx(x,{id:"full-name",placeholder:"Bruce Wayne"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(g,{className:"form-label",for:"post",children:"Post"}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(be,{size:15})}),e.jsx(x,{id:"post",placeholder:"Web Developer"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(g,{className:"form-label",for:"email",children:"Email"}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(de,{size:15})}),e.jsx(x,{type:"email",id:"email",placeholder:"brucewayne@email.com"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(g,{className:"form-label",for:"joining-date",children:"Joining Date"}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(Ce,{size:15})}),e.jsx(je,{className:"form-control",id:"joining-date",value:s,onChange:m=>d(m)})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(g,{className:"form-label",for:"salary",children:"Salary"}),e.jsxs(v,{children:[e.jsx(y,{children:e.jsx(Ne,{size:15})}),e.jsx(x,{type:"number",id:"salary"})]})]}),e.jsx(w,{className:"me-1",color:"primary",onClick:r,children:"Submit"}),e.jsx(w,{color:"secondary",onClick:r,outline:!0,children:"Cancel"})]})]})},Ie=i.forwardRef((c,r)=>e.jsx("div",{className:"form-check",children:e.jsx(x,{type:"checkbox",ref:r,...c})})),ns=()=>{const[c,r]=i.useState([]),[s,d]=i.useState(!1),[n,m]=i.useState(0),[p,j]=i.useState(""),[u,N]=i.useState([]),[T,D]=i.useState(0),[z,B]=i.useState(10),[R,S]=i.useState([]),[M,f]=i.useState(!0),U=new P,V=pe(),A=()=>d(!s);De("deals",a=>{a.response&&a.response.status===401&&U.refreshToken()},a=>{console.log(a)},a=>{f(!0);const t=a.deals;S(l=>{const o=l.findIndex(h=>h.id===t.id);return o!==-1?(t.status=t.status==="approved"?"approved":"pending",[...l.slice(0,o),t,...l.slice(o+1)]):l}),setTimeout(()=>{f(!1),toast(e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"me-1",children:e.jsx(xe,{size:"sm",color:"success",icon:e.jsx(Re,{size:12})})}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("h6",{children:"Form Updated!"}),e.jsx("div",{}),e.jsx("span",{children:"List refreshed!"})]})]}))},400)});const k=async(a=n)=>{try{f(!0);const{deals:t,total:l,itemsPerPage:o}=await C(a,z);S(t),D(l),B(o),f(!1)}catch(t){console.log(t),f(!1)}},O=Le(k,V);i.useEffect(()=>{k()},[n]);const H=async a=>{const t=a.target.value;if(j(t),t.length){const{deals:l,total:o}=await C(1,10,t);N(l),D(o)}else{const{deals:l,total:o}=await C(1,10);N([]),S(l),D(o)}},$=a=>{m(a.selected)};function G(){return e.jsx(ie,{previousLabel:"",nextLabel:"",forcePage:n,onPageChange:a=>$(a),pageCount:T>0?Math.ceil(T/z):1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"})}const Q=()=>G();function J(a){let t;const l=",",o=`
`,h=Object.keys(R[0]);return t="",t+=h.join(l),t+=o,a.forEach(X=>{let E=0;h.forEach(q=>{E>0&&(t+=l),t+=X[q],E++}),t+=o}),t}async function K(){let a;c.length>0?a=c:a=(await C(1,null,p)).deals;const t=document.createElement("a");let l=J(a);if(l===null)return;const o="export.csv";l.match(/^data:text\/csv/i)||(l=`data:text/csv;charset=utf-8,${l}`),t.setAttribute("href",encodeURI(l)),t.setAttribute("download",o),t.click()}return e.jsxs(i.Fragment,{children:[e.jsxs(we,{children:[e.jsxs(Pe,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e.jsx(Te,{tag:"h4",children:"Admins List"}),e.jsxs("div",{className:"d-flex mt-md-0 mt-1",children:[e.jsxs(ze,{children:[e.jsxs(W,{color:"secondary",caret:!0,outline:!0,children:[e.jsx(ae,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Export"})]}),e.jsxs(I,{children:[e.jsxs(b,{className:"w-100",children:[e.jsx(te,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Print"})]}),e.jsxs(b,{className:"w-100",onClick:()=>K(),children:[e.jsx(_,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"CSV"})]})]})]}),e.jsxs(w,{className:"ms-2",color:"primary",onClick:A,children:[e.jsx(ne,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e.jsx(Se,{className:"justify-content-end mx-0",children:e.jsxs(ke,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e.jsx(g,{className:"me-1",for:"search-input",children:"Search"}),e.jsx(x,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:p,onChange:H})]})}),e.jsx("div",{className:"react-dataTable react-dataTable-selectable-rows",children:M?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(ue,{color:"primary"})}):e.jsx(le,{noHeader:!0,pagination:!0,onPageChange:a=>k(a+1),selectableRows:!0,columns:O,paginationPerPage:10,className:"react-dataTable",sortIcon:e.jsx(re,{size:10}),paginationComponent:Q,paginationDefaultPage:n+1,selectableRowsComponent:Ie,data:p.length?u:R,onSelectedRowsChange:a=>r(a.selectedRows)})})]}),e.jsx(We,{open:s,handleModal:A})]})};export{ns as default};
