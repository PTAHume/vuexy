import{D,a0 as K,ag as Y,w as e,L as y,r as d,B as v}from"./index-36eea213.js";import{A as Z,E as _,M as ee,a as se,b as ae,B as te,D as re,S as ne,P as le,c as ie,Q as ce,C as oe,R as de}from"./index.es-c9e4e93b.js";import{A as k,U as me,D as U,b as A,c as N,F as E,d as ue,M as he,X as xe,a as pe,P as je}from"./App-ea01a0bd.js";import{I as h,L as x}from"./Label-ee3701d7.js";import{M as ge,T as fe,u as Ce}from"./useSubscribeToChannel-af8d44fe.js";import{F as Ne}from"./flatpickr-5649bde6.js";import{I as f,a as C}from"./InputGroupText-504b5ed9.js";import{C as be,U as we}from"./calendar-635f668a.js";import{R as ye,C as ve}from"./Col-bbc54cc1.js";import{C as ke}from"./Card-c88ca072.js";import{C as Se}from"./CardHeader-1b4b68dc.js";import{C as De}from"./CardTitle-0c412d9d.js";import{C as Le}from"./check-5ab0dc7d.js";import"./Fade-0bbefbef.js";import"./pusher-ef6f9223.js";const Pe=new D,ze=K("user/updateUserStatus",async({userId:i,status:n},{dispatch:s})=>{try{return await Pe.updateUserStatus(i,n),s(Y.actions.updateUserStatus({userId:i,status:n})),n}catch(c){throw console.log(c),new Error("Error updating status")}}),Re=["success","danger","warning","info","dark","primary","secondary"],S=new D,Te=(i,n)=>[{name:"ID",sortable:!0,maxWidth:"100px",selector:s=>s.id},{name:"Name",sortable:!0,minWidth:"225px",selector:s=>s.name,cell:s=>e.jsxs("div",{className:"d-flex align-items-center",children:[s.image===""?e.jsx(k,{color:`light-${Re[s.status]}`,content:s.name,initials:!0}):e.jsx(k,{img:`${S.baseurl()}${s.image}`}),e.jsx("div",{className:"user-info text-truncate ms-1",children:e.jsx("span",{className:"d-block fw-bold text-truncate",children:e.jsx(y,{to:`${s.id}/edit`,state:{userDatas:s},children:s.name})})})]})},{name:"Email",sortable:!0,minWidth:"310px",selector:s=>s.email},{name:"Mobile",sortable:!0,minWidth:"250px",selector:s=>s.mobile},{name:"Status",sortable:!0,minWidth:"175px",selector:s=>s.status,cell:s=>{const[c,o]=d.useState(parseInt(s.status,10)===1),p=async()=>{try{const u=c?0:1;toast.promise(n(ze({userId:s.id,status:u})),{position:"bottom-left",loading:"Updating the Status...",success:()=>(o(!c),"Saved successfully!"),error:b=>(console.log(b),"Error updating!")})}catch(u){return console.log(u),"Invalid Data!"}};return e.jsxs("div",{className:"form-switch form-check-primary",children:[e.jsx(h,{type:"switch",name:"icon-primary",id:"icon-primary",checked:c,onChange:()=>o(!c),onClick:p}),e.jsx("div",{style:{marginTop:"-1.4rem"},children:c?"Active":"InActive"})]})}},{name:"Actions",allowOverflow:!0,cell:s=>{const c=async()=>{try{await S.deleteUser(s.id),console.log("User deleted successfully"),i()}catch(o){console.log(o)}};return e.jsxs("div",{className:"d-flex",children:[e.jsxs(me,{children:[e.jsx(U,{className:"pe-1",tag:"span",style:{cursor:"pointer"},children:e.jsx(ge,{size:15})}),e.jsxs(A,{end:!0,children:[e.jsxs(N,{tag:y,to:`${s.id}/edit`,className:"w-100",children:[e.jsx(E,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Details"})]}),e.jsxs(N,{tag:"a",href:"/",className:"w-100",onClick:o=>o.preventDefault(),children:[e.jsx(Z,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Archive"})]}),e.jsxs(N,{tag:"a",href:"/",className:"w-100",onClick:o=>{o.preventDefault(),c(s.id)},children:[e.jsx(fe,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Delete"})]})]})]}),e.jsx(y,{to:`${s.id}/edit`,children:e.jsx(_,{size:15})})]})}}],Ue=async()=>{try{return(await S.getAllUserData()).data}catch(i){console.log(i)}},Ae=({open:i,handleModal:n})=>{const[s,c]=d.useState(new Date),o=e.jsx(xe,{className:"cursor-pointer",size:15,onClick:n});return e.jsxs(ee,{isOpen:i,toggle:n,className:"sidebar-sm",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e.jsx(se,{className:"mb-1",toggle:n,close:o,tag:"div",children:e.jsx("h5",{className:"modal-title",children:"New Record"})}),e.jsxs(ae,{className:"flex-grow-1",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx(x,{className:"form-label",for:"full-name",children:"Full Name"}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(ue,{size:15})}),e.jsx(h,{id:"full-name",placeholder:"Bruce Wayne"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(x,{className:"form-label",for:"post",children:"Post"}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(te,{size:15})}),e.jsx(h,{id:"post",placeholder:"Web Developer"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(x,{className:"form-label",for:"email",children:"Email"}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(he,{size:15})}),e.jsx(h,{type:"email",id:"email",placeholder:"brucewayne@email.com"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(x,{className:"form-label",for:"joining-date",children:"Joining Date"}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(be,{size:15})}),e.jsx(Ne,{className:"form-control",id:"joining-date",value:s,onChange:p=>c(p)})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(x,{className:"form-label",for:"salary",children:"Salary"}),e.jsxs(f,{children:[e.jsx(C,{children:e.jsx(re,{size:15})}),e.jsx(h,{type:"number",id:"salary"})]})]}),e.jsx(v,{className:"me-1",color:"primary",onClick:n,children:"Submit"}),e.jsx(v,{color:"secondary",onClick:n,outline:!0,children:"Cancel"})]})]})},Ee=d.forwardRef((i,n)=>e.jsx("div",{className:"form-check",children:e.jsx(h,{type:"checkbox",ref:n,...i})})),Ye=()=>{const[i,n]=d.useState([]),[s,c]=d.useState(!1),[o,p]=d.useState(0),[u,b]=d.useState(""),[L,W]=d.useState([]),[j,P]=d.useState([]),[I,g]=d.useState(!0),M=new D,B=pe(),z=()=>c(!s),F=t=>{t.response&&t.response.status===401&&M.refreshToken()},$=t=>{console.log(t)},V=t=>{g(!0);const a=t.users;P(l=>{const r=l.findIndex(m=>m.id===(a==null?void 0:a.id));return r!==-1?[...l.slice(0,r),a,...l.slice(r+1)]:l}),setTimeout(()=>{g(!1),toast(e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"me-1",children:e.jsx(k,{size:"sm",color:"success",icon:e.jsx(Le,{size:12})})}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("h6",{children:"Form Updated!"}),e.jsx("div",{}),e.jsx("span",{children:"List Updated by Admin!"})]})]}))},400)},R=async()=>{try{g(!0);const t=await Ue();P(t),g(!1)}catch(t){console.log(t),g(!1)}},O=Te(R,B);d.useEffect(()=>{R()},[]),Ce("users",F,$,V);const H=t=>{const a=t.target.value;let l=[];b(a),a.length&&(l=j.filter(r=>{const m=r.name.toLowerCase().startsWith(a.toLowerCase())||r.email.toLowerCase().startsWith(a.toLowerCase())||r.mobile.toLowerCase().startsWith(a.toLowerCase())||r.image.toLowerCase().startsWith(a.toLowerCase()),w=r.name.toLowerCase().includes(a.toLowerCase())||r.email.toLowerCase().includes(a.toLowerCase())||r.mobile.toLowerCase().startsWith(a.toLowerCase())||r.image.toLowerCase().startsWith(a.toLowerCase());return m||(!m&&w?w:null)}),W(l),b(a))},G=t=>{p(t.selected)},Q=()=>e.jsx(de,{previousLabel:"",nextLabel:"",forcePage:o,onPageChange:t=>G(t),pageCount:u.length?Math.ceil(L.length/7):Math.ceil(j.length/7)||1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"});function J(t){let a;const l=",",r=`
`,m=Object.keys(j[0]);return a="",a+=m.join(l),a+=r,t.forEach(w=>{let T=0;m.forEach(q=>{T>0&&(a+=l),a+=w[q],T++}),a+=r}),a}function X(){const t=i.length>0?i:j,a=document.createElement("a");let l=J(t);if(l===null)return;const r="export.csv";l.match(/^data:text\/csv/i)||(l=`data:text/csv;charset=utf-8,${l}`),a.setAttribute("href",encodeURI(l)),a.setAttribute("download",r),a.click()}return e.jsxs(d.Fragment,{children:[e.jsxs(ke,{children:[e.jsxs(Se,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e.jsx(De,{tag:"h4",children:"Users List"}),e.jsxs("div",{className:"d-flex mt-md-0 mt-1",children:[e.jsxs(we,{children:[e.jsxs(U,{color:"secondary",caret:!0,outline:!0,children:[e.jsx(ne,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Export"})]}),e.jsxs(A,{children:[e.jsxs(N,{className:"w-100",children:[e.jsx(le,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Print"})]}),e.jsxs(N,{className:"w-100",onClick:()=>X(),children:[e.jsx(E,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"CSV"})]})]})]}),e.jsxs(v,{className:"ms-2",color:"primary",onClick:z,children:[e.jsx(ie,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e.jsx(ye,{className:"justify-content-end mx-0",children:e.jsxs(ve,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e.jsx(x,{className:"me-1",for:"search-input",children:"Search"}),e.jsx(h,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:u,onChange:H})]})}),e.jsx("div",{className:"react-dataTable react-dataTable-selectable-rows",children:I?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(je,{color:"primary"})}):e.jsx(ce,{noHeader:!0,pagination:!0,selectableRows:!0,columns:O,paginationPerPage:7,className:"react-dataTable",sortIcon:e.jsx(oe,{size:10}),paginationComponent:Q,paginationDefaultPage:o+1,selectableRowsComponent:Ee,data:u.length?L:j,onSelectedRowsChange:t=>n(t.selectedRows)})})]}),e.jsx(Ae,{open:s,handleModal:z})]})};export{Ye as default};
