import{D as S,a0 as Q,a5 as J,r,w as e,B as D}from"./index-ac591294.js";import{M as X,a as $,b as q,B as K,D as Y,S as Z,P as _,c as ee,Q as se,C as ae,R as te}from"./index.es-a1319126.js";import{F as ne}from"./flatpickr-7fc66208.js";import{L as m,I as x}from"./Label-81c82251.js";import{I as h,a as j}from"./InputGroupText-f6caa695.js";import{d as le,M as re,X as ce,a as oe,D as ie,b as de,c as T,F as me,P as xe,A as ue}from"./App-adbdead6.js";import{C as pe,U as he}from"./calendar-ff67fe63.js";import{u as je}from"./useSubscribeToChannel-4572b5e9.js";import"./pusher-ef6f9223.js";import{R as ge,C as fe}from"./Col-c5dc65e3.js";import{C as Ne}from"./Card-6e2046f6.js";import{C as be}from"./CardHeader-411c7504.js";import{C as Ce}from"./CardTitle-ed72f53a.js";import{C as De}from"./check-40336d55.js";import"./Fade-85f57bcd.js";const Se=new S;Q("admin/updateDealStatus",async({dealId:c,status:l},{dispatch:o})=>{try{return await Se.updateDealStatus(c,l),o(J.actions.updateDealStatus({dealId:c,status:l})),l}catch(u){throw console.log(u),new Error("Error updating status")}});new S;const we=({open:c,handleModal:l})=>{const[o,u]=r.useState(new Date),i=e.jsx(ce,{className:"cursor-pointer",size:15,onClick:l});return e.jsxs(X,{isOpen:c,toggle:l,className:"sidebar-sm",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e.jsx($,{className:"mb-1",toggle:l,close:i,tag:"div",children:e.jsx("h5",{className:"modal-title",children:"New Record"})}),e.jsxs(q,{className:"flex-grow-1",children:[e.jsxs("div",{className:"mb-1",children:[e.jsx(m,{className:"form-label",for:"full-name",children:"Full Name"}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(le,{size:15})}),e.jsx(x,{id:"full-name",placeholder:"Bruce Wayne"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(m,{className:"form-label",for:"post",children:"Post"}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(K,{size:15})}),e.jsx(x,{id:"post",placeholder:"Web Developer"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(m,{className:"form-label",for:"email",children:"Email"}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(re,{size:15})}),e.jsx(x,{type:"email",id:"email",placeholder:"brucewayne@email.com"})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(m,{className:"form-label",for:"joining-date",children:"Joining Date"}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(pe,{size:15})}),e.jsx(ne,{className:"form-control",id:"joining-date",value:o,onChange:g=>u(g)})]})]}),e.jsxs("div",{className:"mb-1",children:[e.jsx(m,{className:"form-label",for:"salary",children:"Salary"}),e.jsxs(h,{children:[e.jsx(j,{children:e.jsx(Y,{size:15})}),e.jsx(x,{type:"number",id:"salary"})]})]}),e.jsx(D,{className:"me-1",color:"primary",onClick:l,children:"Submit"}),e.jsx(D,{color:"secondary",onClick:l,outline:!0,children:"Cancel"})]})]})},ve=r.forwardRef((c,l)=>e.jsx("div",{className:"form-check",children:e.jsx(x,{type:"checkbox",ref:l,...c})})),Ge=()=>{const[c,l]=r.useState([]),[o,u]=r.useState(!1),[i,g]=r.useState(0),[f,z]=r.useState(""),[E,w]=r.useState([]),[v,N]=r.useState(0),[k,L]=r.useState(10),[y,b]=r.useState([]),[I,p]=r.useState(!0),A=new S,B=oe(),P=()=>u(!o);je("deals",s=>{s.response&&s.response.status===401&&A.refreshToken()},s=>{console.log(s)},s=>{p(!0);const a=s.deals;b(t=>{const n=t.findIndex(d=>d.id===a.id);return n!==-1?(a.status=a.status==="approved"?"approved":"pending",[...t.slice(0,n),a,...t.slice(n+1)]):t}),setTimeout(()=>{p(!1),toast(e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"me-1",children:e.jsx(ue,{size:"sm",color:"success",icon:e.jsx(De,{size:12})})}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("h6",{children:"Form Updated!"}),e.jsx("div",{}),e.jsx("span",{children:"List refreshed!"})]})]}))},400)});const C=async(s=i)=>{try{p(!0);const{deals:a,total:t,itemsPerPage:n}=await getData(s,k);b(a),N(t),L(n),p(!1)}catch(a){console.log(a),p(!1)}},F=getColumns(C,B);r.useEffect(()=>{C()},[i]);const M=async s=>{const a=s.target.value;if(z(a),a.length){const{deals:t,total:n}=await getData(1,10,a);w(t),N(n)}else{const{deals:t,total:n}=await getData(1,10);w([]),b(t),N(n)}},W=s=>{g(s.selected)},U=()=>e.jsx(te,{previousLabel:"",nextLabel:"",forcePage:i,onPageChange:s=>W(s),pageCount:v>0?Math.ceil(v/k):1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"});function V(s){let a;const t=",",n=`
`,d=Object.keys(y[0]);return a="",a+=d.join(t),a+=n,s.forEach(H=>{let R=0;d.forEach(G=>{R>0&&(a+=t),a+=H[G],R++}),a+=n}),a}async function O(){let s;c.length>0?s=c:s=(await getData(1,null,f)).deals;const a=document.createElement("a");let t=V(s);if(t===null)return;const n="export.csv";t.match(/^data:text\/csv/i)||(t=`data:text/csv;charset=utf-8,${t}`),a.setAttribute("href",encodeURI(t)),a.setAttribute("download",n),a.click()}return e.jsxs(r.Fragment,{children:[e.jsxs(Ne,{children:[e.jsxs(be,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e.jsx(Ce,{tag:"h4",children:"Admins List"}),e.jsxs("div",{className:"d-flex mt-md-0 mt-1",children:[e.jsxs(he,{children:[e.jsxs(ie,{color:"secondary",caret:!0,outline:!0,children:[e.jsx(Z,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Export"})]}),e.jsxs(de,{children:[e.jsxs(T,{className:"w-100",children:[e.jsx(_,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Print"})]}),e.jsxs(T,{className:"w-100",onClick:()=>O(),children:[e.jsx(me,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"CSV"})]})]})]}),e.jsxs(D,{className:"ms-2",color:"primary",onClick:P,children:[e.jsx(ee,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e.jsx(ge,{className:"justify-content-end mx-0",children:e.jsxs(fe,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e.jsx(m,{className:"me-1",for:"search-input",children:"Search"}),e.jsx(x,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:f,onChange:M})]})}),e.jsx("div",{className:"react-dataTable react-dataTable-selectable-rows",children:I?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(xe,{color:"primary"})}):e.jsx(se,{noHeader:!0,pagination:!0,onPageChange:s=>C(s+1),selectableRows:!0,columns:F,paginationPerPage:10,className:"react-dataTable",sortIcon:e.jsx(ae,{size:10}),paginationComponent:U,paginationDefaultPage:i+1,selectableRowsComponent:ve,data:f.length?E:y,onSelectedRowsChange:s=>l(s.selectedRows)})})]}),e.jsx(we,{open:o,handleModal:P})]})};export{Ge as default};
