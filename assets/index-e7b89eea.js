import{D as P,a0 as F,b6 as B,w as e,r as t,L as S,Q as H,B as Q}from"./index-efe58744.js";import{A as V,E as $,S as K,P as O,a as q,Q as G,C as J,R as X}from"./index.es-b9c575a0.js";import{U as Y,D as w,b as T,c as x,F as Z,a as ee,P as ae}from"./App-4109db70.js";import{I as D,L as se}from"./Label-c55cbfeb.js";import{M as te,T as ne}from"./trash-bd0150c7.js";import{R as re,C as le}from"./Col-0aa9be94.js";import{C as ie}from"./Card-b37461ee.js";import{C as ce}from"./CardHeader-97822278.js";import{C as oe}from"./CardTitle-4f77fa1e.js";import{U as de}from"./UncontrolledButtonDropdown-c0bb5b1d.js";const me=new P,pe=F("front/updateMyDealStatus",async({dealId:l,status:n},{dispatch:a})=>{try{return await me.updateUserDealStatus(l,n),a(B.actions.updateDealStatus({dealId:l,status:n})),n}catch(i){throw console.log(i),new Error("Error updating status")}}),k=new P,ue=(l,n)=>[{name:"ID",sortable:!0,maxWidth:"100px",selector:a=>a.id},{name:"User",sortable:!0,minWidth:"180px",cell:a=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"30px"},children:a.user_name})})},{name:"Departure",sortable:!0,minWidth:"200px",cell:a=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:a.departure_country}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_city}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_airport}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_date})]})},{name:"Arrival",sortable:!0,minWidth:"200px",cell:a=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_country}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_city}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_airport}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_date})]})},{name:"Type",sortable:!0,minWidth:"80px",cell:a=>{switch(a.delivery_type){case"hand_luggage":return"Hand Luggage";case"baggage":return"Baggage";case"document":return"Document";default:return""}}},{name:"Weight (Kg)",sortable:!0,minWidth:"140px",cell:a=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"15px"},children:a.weight})})},{name:"Flight",sortable:!0,minWidth:"100x",cell:a=>e.jsx("div",{children:e.jsxs("div",{children:["Flight : ",a.flight_number]})})},{name:"Price",sortable:!0,minWidth:"70px",selector:a=>a.price},{name:"Status",sortable:!0,minWidth:"153px",selector:a=>a.status,cell:a=>{const[i,s]=t.useState(a.status),[c,o]=t.useState(i==="approved"),p=async()=>{try{const d=c?"pending":"approved";H.promise(n(pe({dealId:a.id,status:d})),{position:"bottom-left",loading:"Updating the Status...",success:()=>(o(!c),s(d),"Saved successfully!"),error:h=>(console.log(h),"Error updating!")})}catch(d){return console.log(d),"Invalid Data!"}};return e.jsxs("div",{className:"form-switch form-check-primary",children:[e.jsx(D,{type:"switch",name:"icon-primary",id:"icon-primary",checked:c,onChange:()=>o(!c),onClick:p}),e.jsx("div",{style:{marginTop:"-1.4rem"},children:c?"Active":"InActive"})]})}},{name:"Actions",allowOverflow:!0,cell:a=>{const i=async()=>{try{await k.deleteUserDeal(a.id),console.log("Deal deleted successfully"),l()}catch(s){console.log(s)}};return e.jsxs("div",{className:"d-flex",children:[e.jsxs(Y,{children:[e.jsx(w,{className:"pe-1",tag:"span",style:{cursor:"pointer"},children:e.jsx(te,{size:15})}),e.jsxs(T,{end:!0,children:[e.jsxs(x,{tag:S,to:`${a.id}/edit`,className:"w-100",children:[e.jsx(Z,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Details"})]}),e.jsxs(x,{tag:"a",href:"/",className:"w-100",onClick:s=>s.preventDefault(),children:[e.jsx(V,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Archive"})]}),e.jsxs(x,{tag:"a",href:"/",className:"w-100",onClick:s=>{s.preventDefault(),i(a.id)},children:[e.jsx(ne,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Delete"})]})]})]}),e.jsx(S,{to:`${a.id}/edit`,children:e.jsx($,{size:15})})]})}}],f=async(l=1,n=10,a="")=>{const i=l>0?l:0;try{const s=await k.getUserListUserDeals(null,i,n,a),c=s.data.slice(0,-1),o=s.data[s.data.length-1].pagination,p=o.total,d=o.perPage;return{deals:c,total:p,itemsPerPage:d}}catch(s){console.log(s)}},ge=t.forwardRef((l,n)=>e.jsx("div",{className:"form-check",children:e.jsx(D,{type:"checkbox",ref:n,...l})})),Se=()=>{const[l,n]=t.useState([]),[a,i]=t.useState(!1),[s,c]=t.useState(0),[o,p]=t.useState(""),[d,h]=t.useState([]),[C,j]=t.useState(0),[b,L]=t.useState(10),[R,N]=t.useState([]),[_,v]=t.useState(!0),U=ee(),z=()=>i(!a),y=async(r=s)=>{try{v(!0);const{deals:m,total:u,itemsPerPage:g}=await f(r,b);N(m),j(u),L(g),v(!1)}catch(m){console.log(m),v(!1)}},W=ue(y,U);t.useEffect(()=>{y()},[s]);const A=async r=>{const m=r.target.value;if(p(m),m.length){const{deals:u,total:g}=await f(1,10,m);h(u),j(g)}else{const{deals:u,total:g}=await f(1,10);h([]),N(u),j(g)}},E=r=>{c(r.selected)};function I(){return e.jsx(X,{previousLabel:"",nextLabel:"",forcePage:s,onPageChange:r=>E(r),pageCount:C>0?Math.ceil(C/b):1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"})}const M=()=>I();return e.jsx(t.Fragment,{children:e.jsxs(ie,{children:[e.jsxs(ce,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e.jsx(oe,{tag:"h4",children:"My Deals List"}),e.jsxs("div",{className:"d-flex mt-md-0 mt-1",children:[e.jsxs(de,{children:[e.jsxs(w,{color:"secondary",caret:!0,outline:!0,children:[e.jsx(K,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Export"})]}),e.jsx(T,{children:e.jsxs(x,{className:"w-100",children:[e.jsx(O,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Print"})]})})]}),e.jsxs(Q,{className:"ms-2",color:"primary",onClick:z,children:[e.jsx(q,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e.jsx(re,{className:"justify-content-end mx-0",children:e.jsxs(le,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e.jsx(se,{className:"me-1",for:"search-input",children:"Search"}),e.jsx(D,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:o,onChange:A})]})}),e.jsx("div",{className:"react-dataTable react-dataTable-selectable-rows",children:_?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(ae,{color:"primary"})}):e.jsx(G,{noHeader:!0,pagination:!0,onPageChange:r=>y(r+1),selectableRows:!0,columns:W,paginationPerPage:10,className:"react-dataTable",sortIcon:e.jsx(J,{size:10}),paginationComponent:M,paginationDefaultPage:s+1,selectableRowsComponent:ge,data:o.length?d:R,onSelectedRowsChange:r=>n(r.selectedRows)})})]})})};export{Se as default};
