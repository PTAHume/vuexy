import{D as P,a0 as M,b6 as B,w as e,r as t,L as S,B as H}from"./index-96355820.js";import{A as V,E as Q,S as $,P as K,a as O,Q as q,C as G,R as J}from"./index.es-b5b9f9e0.js";import{U as X,D as w,b as T,c as x,F as Y,a as Z,P as ee}from"./App-36e6b9de.js";import{I as C,L as ae}from"./Label-1299d06b.js";import{M as se,T as te}from"./trash-cebd8b65.js";import{R as ne,C as re}from"./Col-b5a9f876.js";import{C as le}from"./Card-484aa844.js";import{C as ie}from"./CardHeader-66336c9b.js";import{C as ce}from"./CardTitle-79832de0.js";import{U as oe}from"./UncontrolledButtonDropdown-f4996814.js";new P;const de=M("front/updateDealStatus",async({dealId:l,status:r},{dispatch:a})=>{try{return a(B.actions.updateDealStatus({dealId:l,status:r})),r}catch(i){throw console.log(i),new Error("Error updating status")}}),k=new P,me=(l,r)=>[{name:"ID",sortable:!0,maxWidth:"100px",selector:a=>a.id},{name:"User",sortable:!0,minWidth:"180px",cell:a=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"30px"},children:a.user_name})})},{name:"Departure",sortable:!0,minWidth:"200px",cell:a=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:a.departure_country}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_city}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_airport}),e.jsx("div",{style:{marginTop:"5px"},children:a.departure_date})]})},{name:"Arrival",sortable:!0,minWidth:"200px",cell:a=>e.jsxs("div",{children:[e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_country}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_city}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_airport}),e.jsx("div",{style:{marginTop:"5px"},children:a.arrival_date})]})},{name:"Type",sortable:!0,minWidth:"80px",cell:a=>{switch(a.delivery_type){case"hand_luggage":return"Hand Luggage";case"baggage":return"Baggage";case"document":return"Document";default:return""}}},{name:"Weight (Kg)",sortable:!0,minWidth:"140px",cell:a=>e.jsx("div",{children:e.jsx("div",{style:{marginTop:"15px"},children:a.weight})})},{name:"Flight",sortable:!0,minWidth:"100x",cell:a=>e.jsx("div",{children:e.jsxs("div",{children:["Flight : ",a.flight_number]})})},{name:"Price",sortable:!0,minWidth:"70px",selector:a=>a.price},{name:"Status",sortable:!0,minWidth:"153px",selector:a=>a.status,cell:a=>{const[i,s]=t.useState(a.status),[c,o]=t.useState(i==="approved"),p=async()=>{try{const d=c?"pending":"approved";toast.promise(r(de({dealId:a.id,status:d})),{position:"bottom-left",loading:"Updating the Status...",success:()=>(o(!c),s(d),"Saved successfully!"),error:h=>(console.log(h),"Error updating!")})}catch(d){return console.log(d),"Invalid Data!"}};return e.jsxs("div",{className:"form-switch form-check-primary",children:[e.jsx(C,{type:"switch",name:"icon-primary",id:"icon-primary",checked:c,onChange:()=>o(!c),onClick:p}),e.jsx("div",{style:{marginTop:"-1.4rem"},children:c?"Active":"InActive"})]})}},{name:"Actions",allowOverflow:!0,cell:a=>{const i=async()=>{try{await k.deleteDeal(a.id),console.log("Deal deleted successfully"),l()}catch(s){console.log(s)}};return e.jsxs("div",{className:"d-flex",children:[e.jsxs(X,{children:[e.jsx(w,{className:"pe-1",tag:"span",style:{cursor:"pointer"},children:e.jsx(se,{size:15})}),e.jsxs(T,{end:!0,children:[e.jsxs(x,{tag:S,to:`${a.id}/edit`,className:"w-100",children:[e.jsx(Y,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Details"})]}),e.jsxs(x,{tag:"a",href:"/",className:"w-100",onClick:s=>s.preventDefault(),children:[e.jsx(V,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Archive"})]}),e.jsxs(x,{tag:"a",href:"/",className:"w-100",onClick:s=>{s.preventDefault(),i(a.id)},children:[e.jsx(te,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Delete"})]})]})]}),e.jsx(S,{to:`${a.id}/edit`,children:e.jsx(Q,{size:15})})]})}}],y=async(l=1,r=10,a="")=>{const i=l>0?l:0;try{const s=await k.getUserDeals(i,r,a),c=s.data.slice(0,-1),o=s.data[s.data.length-1].pagination,p=o.total,d=o.perPage;return{deals:c,total:p,itemsPerPage:d}}catch(s){console.log(s)}},pe=t.forwardRef((l,r)=>e.jsx("div",{className:"form-check",children:e.jsx(C,{type:"checkbox",ref:r,...l})})),be=()=>{const[l,r]=t.useState([]),[a,i]=t.useState(!1),[s,c]=t.useState(0),[o,p]=t.useState(""),[d,h]=t.useState([]),[D,j]=t.useState(0),[b,L]=t.useState(10),[R,N]=t.useState([]),[_,v]=t.useState(!0),z=Z(),W=()=>i(!a),f=async(n=s)=>{try{v(!0);const{deals:m,total:u,itemsPerPage:g}=await y(n,b);N(m),j(u),L(g),v(!1)}catch(m){console.log(m),v(!1)}},A=me(f,z);t.useEffect(()=>{f()},[s]);const E=async n=>{const m=n.target.value;if(p(m),m.length){const{deals:u,total:g}=await y(1,10,m);h(u),j(g)}else{const{deals:u,total:g}=await y(1,10);h([]),N(u),j(g)}},I=n=>{c(n.selected)};function U(){return e.jsx(J,{previousLabel:"",nextLabel:"",forcePage:s,onPageChange:n=>I(n),pageCount:D>0?Math.ceil(D/b):1,breakLabel:"...",pageRangeDisplayed:2,marginPagesDisplayed:2,activeClassName:"active",pageClassName:"page-item",breakClassName:"page-item",nextLinkClassName:"page-link",pageLinkClassName:"page-link",breakLinkClassName:"page-link",previousLinkClassName:"page-link",nextClassName:"page-item next-item",previousClassName:"page-item prev-item",containerClassName:"pagination react-paginate separated-pagination pagination-sm justify-content-end pe-1 mt-1"})}const F=()=>U();return e.jsx(t.Fragment,{children:e.jsxs(le,{children:[e.jsxs(ie,{className:"flex-md-row flex-column align-md-items-center align-items-start border-bottom",children:[e.jsx(ce,{tag:"h4",children:"My Deals List"}),e.jsxs("div",{className:"d-flex mt-md-0 mt-1",children:[e.jsxs(oe,{children:[e.jsxs(w,{color:"secondary",caret:!0,outline:!0,children:[e.jsx($,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Export"})]}),e.jsx(T,{children:e.jsxs(x,{className:"w-100",children:[e.jsx(K,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Print"})]})})]}),e.jsxs(H,{className:"ms-2",color:"primary",onClick:W,children:[e.jsx(O,{size:15}),e.jsx("span",{className:"align-middle ms-50",children:"Add Record"})]})]})]}),e.jsx(ne,{className:"justify-content-end mx-0",children:e.jsxs(re,{className:"d-flex align-items-center justify-content-end mt-1",md:"6",sm:"12",children:[e.jsx(ae,{className:"me-1",for:"search-input",children:"Search"}),e.jsx(C,{className:"dataTable-filter mb-50",type:"text",bsSize:"sm",id:"search-input",value:o,onChange:E})]})}),e.jsx("div",{className:"react-dataTable react-dataTable-selectable-rows",children:_?e.jsx("div",{className:"d-flex justify-content-center align-items-center py-5",children:e.jsx(ee,{color:"primary"})}):e.jsx(q,{noHeader:!0,pagination:!0,onPageChange:n=>f(n+1),selectableRows:!0,columns:A,paginationPerPage:10,className:"react-dataTable",sortIcon:e.jsx(G,{size:10}),paginationComponent:F,paginationDefaultPage:s+1,selectableRowsComponent:pe,data:o.length?d:R,onSelectedRowsChange:n=>r(n.selectedRows)})})]})})};export{be as default};
