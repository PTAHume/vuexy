import{r as S,w as e,C as E,D as W,b as Ie,B as le,a6 as O,a3 as ne,s as H,Q as Pe,a7 as ce,a8 as Le,a9 as Re,aa as He}from"./index-799ec526.js";import{A as Me,a as G,g as oe,s as P}from"./App-76c3559e.js";import{u as de,C as x}from"./index.esm-313d6863.js";import{R as M,C as F}from"./Col-740eac10.js";import{C as ue}from"./Card-2b73a7fd.js";import{C as me}from"./CardBody-5a0c752d.js";import{C as he}from"./CardHeader-1a15b067.js";import{C as fe}from"./CardTitle-2ca3b30f.js";import{F as pe}from"./Form-b15e587b.js";import{F as N}from"./FormFeedback-152d02b5.js";import{F as T,f as se,a as Te}from"./index.esm-a79e25f0.js";import{I as z,L as w}from"./Label-7980a7d7.js";import{S as L}from"./react-select.esm-cbe66f8b.js";import{C as Ue}from"./check-786ae700.js";import{A as Be,w as Ve,S as ze}from"./ext-component-sweet-alerts-cca615dd.js";import{F as ie}from"./flatpickr-8c5da3e1.js";import"./Fade-c46db253.js";const Oe=(a,v,_,r,d,h,p)=>{const j=v("departure_country"),m=v("arrival_country"),C=v("departure_city"),g=v("arrival_city");S.useEffect(()=>{(()=>{if(_&&d.dealData&&d.dealData[h]){const t=_.find(i=>i.id===d.dealData[h].departure_country_id);a("departure_country",(t==null?void 0:t.id)||"")}if(_&&d.dealData&&d.dealData[h]){const t=_.find(i=>i.id===d.dealData[h].arrival_country_id);a("arrival_country",(t==null?void 0:t.id)||"")}if(r&&d.dealData&&d.dealData[h]){const t=r.find(i=>i.id===d.dealData[h].departure_city_id);a("departure_city",(t==null?void 0:t.id)||"")}if(r&&d.dealData&&d.dealData[h]){const t=r.find(i=>i.id===d.dealData[h].arrival_city_id);a("arrival_city",(t==null?void 0:t.id)||"")}if(p&&d.dealData&&d.dealData[h]){const t=p.find(i=>i.id===d.dealData[h].arrival_airport_id);a("arrival_airport",(t==null?void 0:t.id)||"")}if(p&&d.dealData&&d.dealData[h]){const t=p.find(i=>i.id===d.dealData[h].departure_airport_id);a("departure_airport",(t==null?void 0:t.id)||"")}})()},[_,p,r,d.dealData,h,a]),S.useEffect(()=>{if(r&&j){const f=r.find(t=>t.country_id===j);a("departure_city",(f==null?void 0:f.id)||"")}},[r,j,a]),S.useEffect(()=>{if(r&&m){const f=r.find(t=>t.country_id===m);a("arrival_city",(f==null?void 0:f.id)||"")}},[r,m,a]),S.useEffect(()=>{if(p&&C){const f=p.find(t=>t.city_id===C);a("departure_airport",(f==null?void 0:f.id)||"")}},[p,C,a]),S.useEffect(()=>{if(p&&g){const f=p.find(t=>t.city_id===g);a("arrival_airport",(f==null?void 0:f.id)||"")}},[p,g,a])},Ye=(a,v,_,r,d,h,p,j)=>{const[m,C]=S.useState([]),[g,f]=S.useState([]),[t,i]=S.useState([]),[D,o]=S.useState([]),n=y=>{if(y){const A=a.filter(k=>k.country_id===y);if(C(A),A.length>0){const k=v.filter(B=>B.city_id===A[0].id);i(k)}else i([])}},U=y=>{if(y){const A=a.filter(k=>k.country_id===y);if(f(A),A.length>0){const k=v.filter(B=>B.city_id===A[0].id);o(k)}else o([])}},u=y=>{y&&_("user_id",y)},b=y=>{if(y){const A=v.filter(k=>k.city_id===y);i(A),A.length>0?_("departure_airport",A[0].id):_("departure_airport","")}else i([])},q=y=>{if(y){const A=v.filter(k=>k.city_id===y);o(A),A.length>0?_("arrival_airport",A[0].id):_("arrival_airport","")}else o([])};return S.useEffect(()=>{r&&n(r.id),p&&U(p.id),j&&u(j.id),d&&b(d.id),h&&q(h.id)},[r,p,d,h,j]),{handleDepartureCountryChange:n,handleArrivalCountryChange:U,handleUserChange:u,filteredDepartureCities:m,filteredArrivalCities:g,filteredDepartureAirports:t,handleDepartureCityChange:b,handleArrivalCityChange:q,filteredArrivalAirports:D}},$e=(a,v,_,r,d,h,p,j,m)=>{const[C,g]=S.useState(!1);return{onSubmit:async t=>{g(!0);const i=o=>{const n=["Select City","Select Country","Select Airport",""," ","Select..."];return typeof o=="object"?o!=null&&Object.keys(o).length>0:typeof o!="object"&&o.toString().length>0&&!n.includes(o)};if(Object.values(t).every(i)&&(!v||Object.keys(v).length===0)){console.log(t.duty_free.value);try{const o={id:_,arrival_airport_id:t.arrival_airport,arrival_city_id:t.arrival_city,arrival_country_id:t.arrival_country,delivery_type:t.delivery_type.value,departure_airport_id:t.departure_airport,departure_city_id:t.departure_city,departure_country_id:t.departure_country,flight_number:t.flight_number,price:t.price,user_id:t.user_id,weight:t.weight,status:t.status.value,departure_date:t.departure_date,arrival_date:t.arrival_date,duty_free:t.duty_free.value,user_authenticated:t.user_authenticated.value},n=await d.updateDeal(o,_);n.status===201&&(g(!1),localStorage.setItem("lastUpdated",Date.now()),h(p(n.data)),j(e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"me-1",children:e.jsx(Me,{size:"sm",color:"success",icon:e.jsx(Ue,{size:12})})}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("h6",{children:"Form Submitted!"}),e.jsx("div",{}),e.jsx("span",{children:"You have successfully updated the Deal details!"})]})]})))}catch(o){if(console.log(o),g(!1),o.response&&o.response.status===422){const n=o.response.data.errors;n.user_name?m("user_name",{type:"manual",message:n.user_name?n.user_name:"Incorrect username"}):n.paflightssword?m("flight",{type:"manual",message:n.flight?n.flight:"Incorrect flight"}):n.delivery_type?m("delivery_type",{type:"manual",message:n.delivery_type?n.delivery_type:"Incorrect delivery type"}):n.price?m("price",{type:"manual",message:n.price?n.price:"Incorrect price"}):n.weight?m("weight",{type:"manual",message:n.weight?n.weight:"Incorrect weight"}):n.departure_airport?m("departure_airport",{type:"manual",message:n.departure_airport?n.departure_airport:"Incorrect departure airport"}):n.arrival_airport?m("arrival_airport",{type:"manual",message:n.arrival_airport?n.arrival_airport:"Incorrect arrival airport"}):n.departure_country?m("departure_country",{type:"manual",message:n.departure_country?n.departure_country:"Incorrect country"}):n.arrival_country?m("arrival_country",{type:"manual",message:n.arrival_country?n.arrival_country:"Incorrect country"}):n.departure_city?m("departure_city",{type:"manual",message:n.departure_city?n.departure_city:"Incorrect city"}):n.arrival_city?m("arrival_city",{type:"manual",message:n.arrival_city?n.arrival_city:"Incorrect city"}):n.arrival_date?m("arrival_date",{type:"manual",message:n.arrival_date?n.arrival_date:"Incorrect date"}):n.departure_date?m("departure_date",{type:"manual",message:n.departure_date?n.departure_date:"Incorrect date"}):n.status&&m("status",{type:"manual",message:n.status?n.status:"Incorrect correct status"})}else console.error("Unexpected error:",o)}}else for(const o in t)if(!i(t[o])){const n=t[o]===""||typeof t[o]=="object"&&Object.keys(t[o]).length===0?`The ${o} field has no available options.`:`The ${o} field is required.`;m(o,{type:"manual",message:n})}},isLoading:C,setIsLoading:g}},Ee={confirmCheckbox:!1},V=Ve(ze),We=({id:a})=>{const v=G(),_=E(),r=new W,{control:d,setError:h,handleSubmit:p,formState:{errors:j}}=de({defaultValues:Ee}),m=async()=>{const g=await V.fire({title:"Are you sure?",text:"Are you sure you would like to delete the deal?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn btn-primary",cancelButton:"btn btn-danger ms-1"},buttonsStyling:!1});if(g.value)try{v(O(!0)),await r.deleteDeal(a),v(O(!1)),V.fire({icon:"success",title:"Deleted!",text:"Your account has been deactivated.",customClass:{confirmButton:"btn btn-success"}}),_(oe())}catch(f){console.log(f)}else g.dismiss===V.DismissReason.cancel&&V.fire({title:"Cancelled",text:"Deletion Cancelled!!",icon:"error",customClass:{confirmButton:"btn btn-success"}})},C=g=>{g.confirmCheckbox===!0?m():h("confirmCheckbox",{type:"manual"})};return e.jsxs(ue,{children:[e.jsx(he,{className:"border-bottom",children:e.jsx(fe,{tag:"h4",children:"Delete Deal"})}),e.jsxs(me,{className:"py-2 my-25",children:[e.jsxs(Be,{color:"warning",children:[e.jsx("h4",{className:"alert-heading",children:"Are you sure you want to delete a deal?"}),e.jsx("div",{className:"alert-body fw-normal",children:"Once you delete your deal, there is no going back. Please be certain."})]}),e.jsxs(pe,{onSubmit:p(C),children:[e.jsxs("div",{className:"form-check",children:[e.jsx(x,{control:d,name:"confirmCheckbox",render:({field:g})=>e.jsx(z,{...g,type:"checkbox",id:"confirmCheckbox",checked:g.value,invalid:j.confirmCheckbox&&!0})}),e.jsx(w,{for:"confirmCheckbox",className:Ie("form-check-label",{"text-danger":j&&j.confirmCheckbox}),children:"I confirm to delete the deal"}),j&&j.confirmCheckbox&&e.jsx(N,{children:"Please confirm that you want to delete a deal"})]}),e.jsx("div",{className:"mt-1",children:e.jsx(le,{color:"danger",children:"Delete Deal"})})]})]})]})},Ge=(a,v,_,r,d)=>{var t,i;const h=a.find(D=>{var o;return D.id===((o=r==null?void 0:r.dealData[d])==null?void 0:o.departure_country_id)}),p=a.find(D=>{var o;return D.id===((o=r==null?void 0:r.dealData[d])==null?void 0:o.arrival_country_id)}),j=v.find(D=>{var o;return D.id===((o=r==null?void 0:r.dealData[d])==null?void 0:o.departure_city_id)}),m=v.find(D=>{var o;return D.id===((o=r==null?void 0:r.dealData[d])==null?void 0:o.arrival_city_id)}),C=_.find(D=>{var o;return D.id===((o=r==null?void 0:r.dealData[d])==null?void 0:o.departure_airport_id)}),g=_.find(D=>{var o;return D.id===((o=r==null?void 0:r.dealData[d])==null?void 0:o.arrival_airport_id)}),f=((i=(t=r.dealData[d])==null?void 0:t.user)==null?void 0:i.find(D=>{var o;return D.id===((o=r==null?void 0:r.dealData[d])==null?void 0:o.user_id.id)}))||null;return{defaultDepartureCountry:h,defaultArrivalCountry:p,defaultDepartureCity:j,defaultArrivalCity:m,defaultDepartureAirport:C,defaultArrivalAirport:g,defaultUser:f}};let R;typeof window<"u"?R=window:typeof self<"u"?R=self:R=globalThis;R.clearTimeout;R.setTimeout;R.cancelAnimationFrame||R.mozCancelAnimationFrame||R.webkitCancelAnimationFrame;R.requestAnimationFrame||R.mozRequestAnimationFrame||R.webkitRequestAnimationFrame;const Qe=({redux:a})=>{var J,K,X,Z,ee,ae,te;E();const v=G(),_=new W,{id:r}=ne(),d=[{value:"approved",label:"Approved"},{value:"pending",label:"Pending"},{value:"rejected",label:"Rejected"}],[h,p]=S.useState(""),j=s=>{const{options:l,children:c,maxHeight:I,getValue:Se}=s,[Fe]=Se(),qe=l.indexOf(Fe)*35,Y=h&&!l.some($=>$.label.toLowerCase().includes(h.toLowerCase())),ke=Y?65:I;return e.jsx(Te,{height:ke,itemCount:Y?1:c.length,itemSize:35,initialScrollOffset:qe,width:"100%",children:({index:$,style:re})=>e.jsx("div",{style:re,children:Y?e.jsx("div",{style:{...re,textAlign:"center"},children:"No Option"}):c[$]})})},m=[{value:"hand_luggage",label:"Hand Luggage"},{value:"baggage",label:"Baggage"},{value:"document",label:"Document"}],C=[{value:0,label:"Inactive"},{value:1,label:"Active"}],g=[{value:0,label:"Unauthenticated"},{value:1,label:"Authenticated"}],f=(J=a.dealData[r])==null?void 0:J.user,{reset:t,control:i,setValue:D,setError:o,watch:n,handleSubmit:U,formState:{errors:u}}=de(),b=H(s=>s.dealData.countries),q=H(s=>s.dealData.cities),y=H(s=>s.dealData.airports);Oe(D,n,b,q,a,r,y);const{defaultDepartureCountry:A,defaultDepartureCity:k,defaultArrivalCity:B,defaultArrivalCountry:ye,defaultUser:ve}=Ge(b,q,y,a,r),{handleDepartureCountryChange:_e,handleArrivalCountryChange:ge,handleDepartureCityChange:je,handleArrivalCityChange:De,handleUserChange:be,filteredDepartureCities:Ce,filteredArrivalCities:Ae,filteredDepartureAirports:xe,filteredArrivalAirports:Ne}=Ye(q,y,D,A,k,B,ye,ve),{onSubmit:we,isLoading:Q}=$e(U,u,r,a,_,v,ce,Pe,o);return e.jsxs(S.Fragment,{children:[e.jsxs(ue,{children:[e.jsx(he,{className:"border-bottom",children:e.jsx(fe,{tag:"h4",children:"Edit Deal Details"})}),e.jsx(me,{className:"py-2 my-25",children:e.jsxs(pe,{className:"mt-2 pt-50",onSubmit:U(we),children:[e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"UserIdAsync",children:"User"}),e.jsx(x,{defaultValue:((K=a==null?void 0:a.dealData[r])==null?void 0:K.user_id)||"",control:i,rules:{required:"Username is required"},id:"UserIDAsync",name:"user_id",render:({field:s})=>{const l=f==null?void 0:f.find(c=>c.id===s.value);return e.jsx(L,{options:[...Array.isArray(f)?f.map(c=>({value:c.id,label:c.name})):[]],classNamePrefix:"select",theme:P,value:l?{value:l.id,label:l.name}:null,onChange:c=>{s.onChange(c.value),be(c.value)}})}}),u.user_id&&e.jsx(N,{children:u.user_id.message})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"flightAsync",children:"Flight"}),e.jsx(x,{defaultValue:((X=a==null?void 0:a.dealData[r])==null?void 0:X.flight_number)||"",control:i,rules:{required:"Flight is required"},id:"flightAsync",name:"flight_number",render:({field:s})=>e.jsx(z,{...s,placeholder:"Flight",type:"text",invalid:u.flight&&!0})}),u.flight&&e.jsx(N,{children:u.flight.message})]})})]}),e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"priceAsync",children:"Price"}),e.jsx(x,{defaultValue:((Z=a==null?void 0:a.dealData[r])==null?void 0:Z.price)||"",control:i,rules:{required:"Price is required"},id:"priceAsync",name:"price",render:({field:s})=>e.jsx(z,{...s,type:"number",placeholder:"Price",invalid:u.price&&!0})}),u.price&&e.jsx(N,{children:u.price.message})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"weightAsync",children:"Weight"}),e.jsx(x,{defaultValue:((ee=a==null?void 0:a.dealData[r])==null?void 0:ee.weight)||"",control:i,rules:{required:"Weight is required"},id:"weightAsync",name:"weight",render:({field:s})=>e.jsx(z,{...s,type:"text",placeholder:"Weight",invalid:u.weight&&!0})}),u.weight&&e.jsx(N,{children:u.weight.message})]})})]}),e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"departure_countryAsync",children:"Departure Country"}),e.jsx(x,{control:i,rules:{required:"Departure country is required"},id:"departure_countryAsync",name:"departure_country",defaultValue:b&&b.find(s=>{var l;return s.id===(a.dealData&&((l=a.dealData[r])==null?void 0:l.departure_country_id))})||"",render:({field:s})=>{const l=b==null?void 0:b.find(c=>c.id===s.value);return e.jsx(L,{options:[...Array.isArray(b)?b.map(c=>({value:c.id,label:c.nicename})):[]],classNamePrefix:"select",theme:P,value:l?{value:l.id,label:l.nicename}:null,onChange:c=>{s.onChange(c.value),_e(c.value)}})}}),u.departure_country&&e.jsx(N,{children:u.departure_country.message})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"arrival_countryAsync",children:"Arrival Country"}),e.jsx(x,{control:i,rules:{required:"Arrival country is required"},id:"arrival_countryAsync",name:"arrival_country",defaultValue:b&&b.find(s=>{var l;return s.id===(a.dealData&&((l=a.dealData[r])==null?void 0:l.arrival_country_id))})||"",render:({field:s})=>{const l=b==null?void 0:b.find(c=>c.id===s.value);return e.jsx(L,{options:[...Array.isArray(b)?b.map(c=>({value:c.id,label:c.nicename})):[]],classNamePrefix:"select",theme:P,value:l?{value:l.id,label:l.nicename}:null,onChange:c=>{s.onChange(c.value),ge(c.value)}})}}),u.arrival_country&&e.jsx(N,{children:u.arrival_country.message})]})})]}),e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"departure_cityAsync",children:"Departure City"}),e.jsx(x,{control:i,rules:{required:"Departure city is required"},id:"departure_cityAsync",name:"departure_city",className:"my-custom-controller",render:({field:s})=>{var c;const l=q==null?void 0:q.find(I=>I.id===s.value);return e.jsxs(T,{className:"my-custom-controller",children:[e.jsx(L,{options:Ce.map(I=>({value:I.id,label:I.name})),classNamePrefix:"select",theme:P,value:l?{value:l.id,label:l.name}:null,onChange:I=>{s.onChange(I.value),je(I.value)},className:u.departure_city?"is-invalid":"",components:{MenuList:j},onInputChange:I=>p(I)}),e.jsx(N,{children:(c=u.departure_city)==null?void 0:c.message})]})}})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"arrival_cityAsync",children:"Arrival City"}),e.jsx(x,{control:i,rules:{required:"Arrival city is required"},id:"arrival_cityAsync",name:"arrival_city",defaultValue:q&&q.find(s=>{var l;return s.id===(a.dealData&&((l=a.dealData[r])==null?void 0:l.arrival_city_id))})||"",render:({field:s})=>{const l=q==null?void 0:q.find(c=>c.id===s.value);return e.jsxs(T,{className:"my-custom-controller",children:[e.jsx(L,{options:Ae.map(c=>({value:c.id,label:c.name})),classNamePrefix:"select",theme:P,value:l?{value:l.id,label:l.name}:null,onChange:c=>{s.onChange(c.value),De(c.value)},className:u.arrival_city?"is-invalid":"",components:{MenuList:j},onInputChange:c=>p(c)}),u.arrival_city&&e.jsx(N,{children:u.arrival_city.message})]})}})]})})]}),e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"departure_airportAsync",children:"Departure Airport"}),e.jsx(x,{control:i,rules:{required:"Departure Airport is required"},id:"departure_airportAsync",name:"departure_airport",defaultValue:y&&y.find(s=>{var l;return s.id===(a.dealData&&((l=a.dealData[r])==null?void 0:l.departure_airport_id))})||"",render:({field:s})=>{const l=y==null?void 0:y.find(c=>c.id===s.value);return e.jsxs(T,{className:"my-custom-controller",children:[e.jsx(L,{options:xe.map(c=>({value:c.id,label:c.airport_name})),classNamePrefix:"select",theme:P,value:l?{value:l.id,label:l.airport_name}:null,onChange:c=>s.onChange(c.value),className:u.departure_airport?"is-invalid":""}),u.departure_airport&&e.jsx(N,{children:u.departure_airport.message})]})}})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"arrival_airportAsync",children:"Arrival Airport"}),e.jsx(x,{control:i,rules:{required:"Arrival airport is required"},id:"arrival_airportAsync",name:"arrival_airport",defaultValue:y&&y.find(s=>{var l;return s.id===(a.dealData&&((l=a.dealData[r])==null?void 0:l.arrival_airport_id))})||"",render:({field:s})=>{const l=y==null?void 0:y.find(c=>c.id===s.value);return e.jsxs(T,{className:"my-custom-controller",children:[e.jsx(L,{options:Ne.map(c=>({value:c.id,label:c.airport_name})),classNamePrefix:"select",theme:P,value:l?{value:l.id,label:l.airport_name}:null,onChange:c=>s.onChange(c.value),className:u.arrival_airport?"is-invalid":""}),u.arrival_airport&&e.jsx(N,{children:u.arrival_airport.message})]})}})]})})]}),e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"departure_dateAsync",children:"Departure Date"}),e.jsx(x,{control:i,rules:{required:"Departure date is required"},id:"departure_dateAsync",name:"departure_date",defaultValue:((ae=a==null?void 0:a.dealData[r])==null?void 0:ae.departure_date)||"",render:({field:s})=>e.jsx(T,{className:"my-custom-controller",children:e.jsxs("div",{children:[e.jsx(ie,{...s,value:s.value,"data-enable-time":!0,id:"departure-picker",className:`form-control ${u.departure_date?"is-invalid":""}`,options:{dateFormat:"Y-m-d H:i:S",enableTime:!0},onChange:l=>{s.onChange(se(l[0],"yyyy-MM-dd HH:mm:ss"))}}),u.departure_date&&e.jsx(N,{children:u.departure_date.message})]})})})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"arrival_dateAsync",children:"Arrival Date"}),e.jsx(x,{control:i,rules:{required:"Arrival date is required"},id:"arrival_dateAsync",name:"arrival_date",defaultValue:((te=a==null?void 0:a.dealData[r])==null?void 0:te.arrival_date)||"",render:({field:s})=>e.jsx(T,{className:"my-custom-controller",children:e.jsxs("div",{children:[e.jsx(ie,{...s,value:s.value,"data-enable-time":!0,id:"arrival-picker",className:`form-control ${u.arrival_date?"is-invalid":""}`,options:{dateFormat:"Y-m-d H:i:S",enableTime:!0},onChange:l=>{s.onChange(se(l[0],"yyyy-MM-dd HH:mm:ss"))}}),u.arrival_date&&e.jsx(N,{children:u.arrival_date.message})]})})})]})})]}),e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"delivery_type",children:"Delivery Type"}),e.jsx(x,{name:"delivery_type",id:"delivery_typeAsync",defaultValue:m.find(s=>{var l;return s.value===((l=a==null?void 0:a.dealData[r])==null?void 0:l.delivery_type)}),control:i,rules:{required:"Delivery Type is required"},render:({field:s})=>e.jsx(L,{options:m,classNamePrefix:"select",theme:P,...s})}),u.delivery_type&&e.jsx(N,{children:u.delivery_type.message})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"statusAsync",children:"Status"}),e.jsx(x,{id:"react-select",control:i,name:"status",defaultValue:d.find(s=>{var l;return s.value===((l=a==null?void 0:a.dealData[r])==null?void 0:l.status)}),render:({field:s})=>e.jsx(L,{options:d,classNamePrefix:"select",theme:P,...s})}),u.status&&e.jsx(N,{children:u.status.message})]})})]}),e.jsxs(M,{children:[e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"duty_free",children:"Duty Free Delivery"}),e.jsx(x,{name:"duty_free",id:"duty_freeAsync",defaultValue:C.find(s=>{var l;return s.value===((l=a==null?void 0:a.dealData[r])==null?void 0:l.duty_free)}),control:i,rules:{required:"Duty Free Field is required"},render:({field:s})=>e.jsx(L,{options:C,classNamePrefix:"select",theme:P,...s})}),u.duty_free&&e.jsx(N,{children:u.duty_free.message})]})}),e.jsx(F,{md:"6",children:e.jsxs("div",{className:"mb-1",children:[e.jsx(w,{className:"form-label",for:"user_authenticatedAsync",children:"User Authentication"}),e.jsx(x,{id:"react-select",control:i,name:"user_authenticated",defaultValue:g.find(s=>{var l;return s.value===((l=a==null?void 0:a.dealData[r])==null?void 0:l.user_authenticated)}),render:({field:s})=>e.jsx(L,{options:g,classNamePrefix:"select",theme:P,...s})}),u.user_authenticated&&e.jsx(N,{children:u.user_authenticated.message})]})})]}),e.jsx("div",{className:"d-flex",children:e.jsx(le,{className:"me-1",color:"primary",disabled:Q,type:"submit",children:"Submit"})}),e.jsx("div",{id:"loading-overlay",style:{display:Q?"flex":"none"},children:e.jsx("div",{className:"loader"})})]})})]}),e.jsx(We,{id:r})]})},Je=({dataVersion:a})=>{const v=S.useMemo(()=>new W,[]),_=E(),{id:r}=ne(),d=G(),h=H(t=>{var i;return(i=t.dealData)==null?void 0:i.dealData[r]}),p=H(t=>{var i;return(i=t.dealData)==null?void 0:i.version}),j=H(t=>{var i;return(i=t.dealData)==null?void 0:i.countries}),m=H(t=>{var i;return(i=t.dealData)==null?void 0:i.cities}),C=H(t=>{var i;return(i=t.dealData)==null?void 0:i.airports}),[g,f]=S.useState(!1);return S.useEffect(()=>{(async()=>{if(!(h&&p===a))try{d(O(!0));const D=(await v.getDealData(r)).data[0];d(ce(D))}catch(i){console.error("Error fetching deal data:",i),i.response.status===404&&_(oe())}finally{d(O(!1))}})()},[r,d,a,h,p,_,v]),S.useEffect(()=>{(async()=>{if(!g&&(!j.length||!m.length||!C.length))try{const i=await v.getAllData();i&&(j.length||d(Le(i.data.countries)),m.length||d(Re(i.data.cities)),C.length||d(He(i.data.airports)),f(!0))}catch(i){console.error("Error fetching countries, cities, or airports:",i)}})()},[j.length,m.length,C.length,g,d,v]),null},fa=()=>{const a=H(p=>p.dealData),v=a==null?void 0:a.loading,_=a==null?void 0:a.loadingCountries,r=a==null?void 0:a.loadingCities,d=a==null?void 0:a.loadingAirports,h=v||_||r||d;return e.jsxs("div",{children:[e.jsx(Je,{dataVersion:a==null?void 0:a.version}),h?e.jsx("div",{id:"loading-overlay",style:{display:"flex"},children:e.jsx("div",{className:"loader"})}):e.jsx(Qe,{dataVersion:a==null?void 0:a.version,redux:a??""})]})};export{fa as default};
